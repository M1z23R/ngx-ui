<div class="ui-tree-node">
  <div class="ui-tree-node__guides">
    @for (guide of indentGuides(); track guide) {
      <span class="ui-tree-node__guide" [style.width.px]="indent()"></span>
    }
  </div>
  <div
    class="ui-tree-node__content"
    [class.ui-tree-node__content--selected]="false"
    [style.padding-left.px]="level() * indent() + 8"
    (click)="onClick($event)"
    (dblclick)="onDoubleClick($event)"
  >
    @if (hasChildren()) {
      <button
        type="button"
        class="ui-tree-node__toggle"
        [class.ui-tree-node__toggle--expanded]="isExpanded()"
        (click)="toggle($event)"
        [attr.aria-expanded]="isExpanded()"
        [attr.aria-label]="isExpanded() ? 'Collapse' : 'Expand'"
      >
        <svg
          class="ui-tree-node__chevron"
          width="16"
          height="16"
          viewBox="0 0 16 16"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M6 4L10 8L6 12"
            stroke="currentColor"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </button>
    }
    @if (node().icon) {
      <span class="ui-tree-node__icon">{{ node().icon }}</span>
    }
    <span class="ui-tree-node__label">{{ node().label }}</span>
  </div>
</div>
@if (isExpanded() && hasChildren()) {
  @for (child of node().children; track child) {
    <ui-tree-node
      [node]="child"
      [level]="level() + 1"
      [indent]="indent()"
      (nodeClick)="_onChildNodeClick($event)"
      (nodeExpand)="_onChildNodeExpand($event)"
      (nodeCollapse)="_onChildNodeCollapse($event)"
    />
  }
}
